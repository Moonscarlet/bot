import { ChatGPTAPI } from 'chatgpt'
// let _gpt = require('chatgpt');



chatgpt("write a simple vba macro")

async function chatgpt(question) {
    //chatgpt browser token
    const gpttoken= "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..mWjhaq356WdFPY1M.gTyMe_JKMi9Y6DoKmoeC21boJrBeKUKV1uqvNAq2Xx6GNi2TD9RoBbP6XPHbWqVV6Z93z7L2aPqK9ub3e38WtGAAg02kF43Eq11sK3e-boO22E_Exq9_2arfFBni2R2QK03lp3NknKOiUfbCKLv0eFPTNiK4fizu0yjDWAROZ6B232PsD9w5PVCY-ZYVLEc_s6rcS73ZTRkzFrs12BRnoP-zEOdMGM4tK3AQiRcdTRmq9a5n_ZPyzhWulKeF6o8rFyRD6C2r08CxG7iA6Ik9MJNNhqgaaL4IzxcZcXy1eWh8v_KXH7SXN4RjRcD-aFFl3ll6nliIjmPMfDYhuVQReveW_Q1eCvoJZmoNT7u8CTtPiaLpaHAphzDkaDmb7cFYukZW63zpAMRAYCmJjxm4NZ4GJrzdr3UNyh94rxIR17auASkY3dDTsoVk57oUQ6mxvmKuLzLIvZdNMpzbThsICBSxqR463Iz2kxZy5SEzedEv9jv1qhG5osRlzIMzMsNVCu_obNvBlwQWm59IJ_c7IN1M1h2diRr2i8g81nopHGvY5iGwKdx38KjLQVGh5dgAU3hUs5j1EghstQ64DO8Hn8fM2Csec6negjJOkpvoXOE5RejvYqFEDWY4Dtr3frMYaADFpedWhlPaWEx4v71HL_2zLfa0OMPzsdn9q7FLAgj1EBFLuDJ2oMa49cbfe41FcQ7-OT64d9RsEQUYagALep6udHIa-_2_VJZtyNm2y6l51c1u0PXfetCn71oNpvcs4ddTxijRHZ6snYOEF8Br1dKixJcYw5jqPDZrXLrO3FzHQYcLS4wOUuA68muudUc5XfkLW46nzgFn_G2lBUhQZODg3tO_0FrfLNcB5hweXPwLaEFyHi0-e_4q6pjVupaD391klnoJXeNHZerKSnGlJIiLgxdYKDOn5L_TAbpUov5V-6EJ8nGFNBEAn2BX8LavB6MoLSLjiBgRelR6wX8YjBykn4WCyxmaUXH3g02mzxxILdy781PBU-rhF12pA8nHU5x7Ij8VPgTMAK9xFZI-j7Q5Fnd1DaN11XixUqRjCj_TpPSvjFEl7BKGXS03wsw3OF3WjtJceeL4P5V0SLh9IiomttI-cp-o3Mm2TJJQWRhM1Rup98_LqJk2Ouu53pwET-sKwf6VSyKikUBmGbILFZgaoOxq7j5CN25HP_wIMDouvHpc6X3PDrUukwwQIGUgG4XHj6ypAZk9yp_tzzDr_V4u4GQCkng9C378gr1j8aGsxEO_TkYSPWFZCg6UpMtQq8W_tsRhEwIgIQf8G6rF7aQbhkXohCNkBpBx3MhwPycQzdFDVVqydmH76KIzGbccwHQW0t5NJnFNJ5Li13pvPWMwLvlRON4_BoIXxU5HSHEiQ5MTUpASOLHc8RMc667LHKl9vj37qcby9e7kYOgpQj9CVKlsRZ5vWnGe2oywx6WqU2swNuKrEEd12ixwIuV77UrFGB2DGPtaGwY65INlBhaw5VXiOAseqGHqSS0twGvWHHF2XWR0utCGJYj00b0EocvGyNcCL4g7B59rpIIyFe1vxglcPgZzJ6qa8vNDG0ar9XIej4uRATOWRrTFwiepVo0-lPmD1DCUUvaN0KknKbY1oG8hAk-AXd2dIcZcgKIlNCYJMMuOxaIZ4kS-OqcqSsL8bK-kjTPSt-2FdddjP43GZlnp9mUHvXKjPqeei8UKBekDWfYOkusj7ULvWdEGC5djgVgZcLlwewGzCqvpDsvsipjqZEs1jFKiYNUgebQLT1agnkr7zM1rBnbs5t_Z5qG2pZyWYKjGyFe6aSIxIjgX79xxy6trTNYMoHn_eZ55BlmsU4sg-wxkKeBpsiEf7pMhIdDE8p3rZae-L05CFHj1Mo4OmRmYAAWGNSCNxwWpCTr8PPjCv_XnKvlT3s3YO1nTJOiu3xSOR9-56Zs8PRp3LORIXpDvzJiItqEHPyLbBRp677FqBpfiIkln_aXYX8IBjzmfD_6jVg-KjqCWuCiPfWbf9kKm-eGmoDmC4nR-uSOV3PsCzADXYCIZeo31Aw4YW4ENu8PjBUzCj2PcKo13JdCgPGM9hjA_vUVXXcVLhr1ZMwE9vFKhb7OHPtPawTwbQAQUWSmaRkbqtq_VPDLTebzBBv_J8K24RkpZgVkwu7o0S6UtXbGtFVtzhDz3y_mu_fEqA61XAI33rSr4hKpvBqBkOXEFE7DTrD1Y9onFpm4jAidsqyRNizx7qbsNyR-mQiAJIXG3RyEucUrWdrkp93n0w88jkcMgblxHPynJ0JQ1S29LuezK6par8j8oyzTUCaFfdKvsfuM1x6b8BVH7I0n2itBXDTR_2T7WArbpiBPBWUjIrZ6Not6C.vccq7zqK4RlYfmXQ0zgYjA"
  
    // sessionToken is required; see below for details
    const api = new ChatGPTAPI({
      sessionToken: gpttoken
    })
  
    // ensure the API is properly authenticated
    await api.ensureAuth()
  
    // send a message and wait for the response
    const response = await api.sendMessage(
      question
    )
  
    // response is a markdown-formatted string
    console.log(response)
  }